<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="styles.css">
    <title>E6 G24</title>
</head>
<body>

    <div class="container">
        <header>
            <h1>Encuentro 6, Grupo 24.</h1>
            <h3>Preparacion de nuestro Proyecto para las futuras clases.</h3>
        </header>

        <section>

            <p>Crearemos un proyecto en Angular desde cero pero instalando manualmente todo lo que vamos a necesitar para el desarrollo de esta Base para las siguientes clases.</p>

            <p>En este caso evitaremos usar el comando <b>ng new nombre-del-proyecto</b> dado que instalaremos a mano lo que necesitemos para ir viendo todo el proceso de creacion del proyecto.</p>

            <p>Estando en Visual Studio Code, usaremos los siguientes comandos para crear el archivo <b>package.json</b> que necesitamos e instalaremos el framework Express junto a las librerias que necesitemos del mismo:</p>

            <p>
                (Si estan en Windows, asegurense de que la Consola este trabajando con CMD). <br>
                <b>npm init --yes</b> : Para crear solo el archivo <b>package.json</b> <br>
                <b>npm i express express-handlebars</b> <br>
                <b>npm i express express-session</b> <br>
                <b>npm i express mysql</b> <br>
                <b>npm i express-mysql-session</b> <br>
                <b>npm i express morgan</b> <br>
                <b>npm i express bcryptjs</b> <br>
                <b>npm i express passport</b> <br>
                <b>npm i express passport-local</b> <br>
                <b>npm i express timeago.js</b> <br> <br>
                Para las validaciones: <br>
                <b>npm i express connect-flash</b> <br>
                <b>npm i express express-validator</b> <br> <br>

                Para la parte de Desarrollo: <br>
                <b>npm i nodemon -D</b> <br> <br>
            </p>

            <p>
                Creamos la carpeta <b>src</b> mas 4 carpetas dentro: <b>lib</b>, <b>public</b>, <b>routers</b> y <b>views</b>.
                Podemos usar la consola para esto de la siguiente forma:
                <br>
                <b>
                    mkdir src <br>
                    cd src <br>
                    mkdir lib public routers views
                </b>

                <br> <br>

                Dentro de la carpeta <b>src</b> creamos los siguientes archivos: <b>index.js</b>, <b>database.js</b> (que usaremos de base de datos) y <b>keys.js</b> (que usaremos para los accesos a la base de datos).

                <br> <br>

                Importamos los modulos utilizando una constante en el <b>index.js</b>
            </p>

            <div class="border">
                <p>SRC > Index.JS:</p>
            <pre>
                <code>
    <span class="new-c">const express = require('express');</span>
    <span class="new-c">const morgan = require('morgan');</span>

    <span class="new-c">//inicializaciones: funciones de inicialización de clases</span>
    <span class="new-c">const app = express();</span>
    <span class="new-c">//configuraciones</span>
    <span class="new-c">app.set('port', process.env.Port || 4000);</span>
    <span class="new-c">//Middelwares: funciones que se ejecutan cada vez que un cliente solicita una petición al servidor</span>
    <span class="new-c">app.use(morgan('dev'));</span>
    <span class="new-c">//Variables globales</span>

    <span class="new-c">//Routes</span>

    <span class="new-c">//Public: Código al cual va acceder el navegador</span>

    <span class="new-c">//satarting the server</span>
    <span class="new-c">app.listen(app.get('port'), () => {</span>
    <span class="new-c">console.log('Serve on port', app.get('port'));</span>
    <span class="new-c">})</span>
                </code>
            </pre>
            </div>

            <p>Ahora vamos al archivo <b>package.json:</b></p>
            <div class="border">
                <p><b>package.json:</b></p>
                <pre>
                    <code>
    {
        "name": "angular-e6-g24",
        "version": "1.0.0",
        "description": "",
        "main": "index.js",
        "scripts": {
          <span class="delete-c">"test": "echo \"Error: no test specified\" && exit 1"</span>
          <span class="new-c">"dev": "nodemon src/index.js"</span>          
          
        },
        "keywords": [],
        "author": "",
        "license": "ISC",
        "dependencies": {
          "bcryptjs": "^2.4.3",
          "connect-flash": "^0.1.1",
          "express": "^4.18.1",
          "express-handlebars": "^6.0.6",
          "express-mysql-session": "^2.1.8",
          "express-session": "^1.17.3",
          "express-validator": "^6.14.1",
          "morgan": "^1.10.0",
          "mysql": "^2.18.1",
          "passport": "^0.6.0",
          "passport-local": "^1.0.0",
          "timeago.js": "^4.0.2"
        },
        "devDependencies": {
          "nodemon": "^2.0.16"
        }
      }
                    </code>
                </pre>
            </div>

            <p>
                En Consola iniciamos Nodemon: <b>npm run dev</b>
                <br>
                Debera correr en Localhost:4000 dando un error (un error positivo, porque vemos que Nodemon esta corriendo pero el error es porque no hemos linqueado nada aun en los archivos).
                <br> <br>
                Nos vamos a la Carpeta <b>routers</b>, creamos el archivo <b>index.js</b> y dentro:
            </p>
            <div class="border">
                <p><b>src > routers > index.js</b></p>
                <pre>
                    <code>
    <span class="new-c">//Acá vamos a guardar todas las ruta principales de nuestro proyecto</span>
    <span class="new-c">const express = require('express');</span>
    <span class="new-c">const router = express.Router();</span>

    <span class="new-c">router.get('/', (req, res) =>{</span>
        <span class="new-c">res.send("Hola Mundo");</span>
    <span class="new-c">});</span>

    <span class="new-c">module.exports = router;</span>
                    </code>
                </pre>
            </div>

            <p>
                Nos movemos a la carpeta <b>src</b>:
            </p>
            <div class="border">
                <p><b>src > index.js</b></p>
                <pre>
                    <code>
    const express = require('express');
    const morgan = require('morgan');
    <span class="new-c">const { engine } = require('express-handlebars');</span>
    <span class="new-c">const path = require('path');</span>

    //inicializaciones: funciones de inicialización de clases
    const app = express();
    //configuraciones
    app.set('port', process.env.Port || 4000);
    <span class="new-c">app.path('views', path.join(__dirname, 'views'));</span>
    <span class="new-c">app.engine('.hbs', engine({</span>
    <span class="new-c">defaultlayout: "main",</span>
    <span class="new-c">layoutsDir: path.join(app.get('views'), 'layouts'),</span>
    <span class="new-c">partialsDir: path.join(app.get('views'), 'partials'),</span>
    <span class="new-c">extname: '.hbs'</span>
    <span class="new-c">}))</span>
    //Middelwares: funciones que se ejecutan cada vez que un cliente solicita una petición al servidor
    app.use(morgan('dev'));
    //Variables globales

    //Routes
    <span class="new-c">app.use(require('./routers/index.js'));</span>

    //Public: Código al cual va acceder el navegador

    //satarting the server
    app.listen(app.get('port'), () => {
    console.log('Serve on port', app.get('port'));
    })
                    </code>
                </pre>
            </div>

            <p>
                En la carpeta <b>lib</b> creamos el archivo <b>handlebars.js</b>
                <br> <br>
                Volvemos a la carpeta <b>src</b>:
            </p>
            <div class="border">
                <p><b>src > index.html</b></p>
                <pre>
                    <code>
    const express = require('express');
    const morgan = require('morgan');
    const { engine } = require('express-handlebars');
    const path = require('path');
    <span class="new-c">helpers: require('./lib/handlebars.js');</span>

    //inicializaciones: funciones de inicialización de clases
    const app = express();
    //configuraciones
    app.set('port', process.env.Port || 4000);
    app.path('views', path.join(__dirname, 'views'));
    app.engine('.hbs', engine({
    defaultlayout: "main",
    layoutsDir: path.join(app.get('views'), 'layouts'),
    partialsDir: path.join(app.get('views'), 'partials'),
    extname: '.hbs'
    }))
    //Middelwares: funciones que se ejecutan cada vez que un cliente solicita una petición al servidor
    app.use(morgan('dev'));
    //Variables globales
    <span class="new-c">app.use((req, res, next)=>{</span>
        <span class="new-c">next();</span>
    <span class="new-c">})</span>        
    //Routes
    app.use(require('./routers/index.js'));

    //Public: Código al cual va acceder el navegador

    //satarting the server
    app.listen(app.get('port'), () => {
    console.log('Serve on port', app.get('port'));
    })
                    </code>
                </pre>
            </div>

            <p>
                En la carpeta <b>routers</b> creamos los archivos <b>autentication.js</b> y <b>links.js</b>.
            </p>

            <div class="border">
                <p><b>src > index.html</b></p>
                <pre>
                    <code>
    const express = require('express');
    const morgan = require('morgan');
    const { engine } = require('express-handlebars');
    const path = require('path');
    helpers: require('./lib/handlebars.js');

    //inicializaciones: funciones de inicialización de clases
    const app = express();
    //configuraciones
    app.set('port', process.env.Port || 4000);
    app.path('views', path.join(__dirname, 'views'));
    app.engine('.hbs', engine({
    defaultlayout: "main",
    layoutsDir: path.join(app.get('views'), 'layouts'),
    partialsDir: path.join(app.get('views'), 'partials'),
    extname: '.hbs'
    }))
    //Middelwares: funciones que se ejecutan cada vez que un cliente solicita una petición al servidor
    app.use(morgan('dev'));
    //Variables globales
    app.use((req, res, next)=>{
        next();
    })        
    //Routes
    app.use(require('./routers/index.js'));
    <span class="new-c">app.use(require('./routers/autentication'));</span>
    <span class="new-c">app.use('/links', require('./routers/links'));</span>

    //Public: Código al cual va acceder el navegador

    //satarting the server
    app.listen(app.get('port'), () => {
    console.log('Serve on port', app.get('port'));
    })
                    </code>
                </pre>
            </div>

            <p>Vamos a la carpeta <b>routers</b> y tanto para <b>autentication.js</b> como para <b>links.js</b> usaremos este mismo codigo:</p>
            <div class="border">
                <p><b>autentication.js</b> y <b>links.js</b>:</p>
                <pre>
                    <code>
    <span class="new-c">const express = require('express');</span>
    <span class="new-c">const router = express.Router();</span>

    <span class="new-c">module.exports = router;</span> 
                    </code>
                </pre>
            </div>


            <p>Creamos la carpeta <b>database</b> en la carpeta del proyecto (fuera de <b>src</b>) y dentro creamos el archivo <b>db.sql</b>:</p>
            <div class="border">
                <p>db.sql</p>
                <pre>
                    <code>
    <span class="new-c">CREATE DATABASE database_link;</span>

    <span class="new-c">USE database_link;</span>

    <span class="new-c">CREATE TABLE users (</span>
        <span class="new-c">id INT(10) PRIMARY KEY NOT NULL,</span>
        <span class="new-c">nom_usuario VARCHAR(100) NOT NULL,</span>
        <span class="new-c">pass VARCHAR(20) NOT NULL</span>
    <span class="new-c">)</span>

    <span class="new-c">CREATE TABLE links (</span>
        <span class="new-c">id int(10) PRIMARY KEY NOT NULL,</span>
        <span class="new-c">link VARCHAR(200) NOT NULL,</span>
        <span class="new-c">observaciones VARCHAR(500)</span>
    <span class="new-c">)</span>
                    </code>
                </pre>
            </div>

            <p>Y con esto concluimos el Encuentro 6.</p>

        </section>
    </div>
    
    
</body>
</html>